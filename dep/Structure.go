package dep

import (
	"image"

	"github.com/hajimehoshi/ebiten/v2"
)

var ImgBase = LoadImg("data/img/sprites.png")

var AllImg []*ebiten.Image = []*ebiten.Image{
	ImgBase.SubImage(image.Rect(128, 16, 144, 32)).(*ebiten.Image), //Mono Wall .... 0
	ImgBase.SubImage(image.Rect(128, 48, 144, 64)).(*ebiten.Image), // ..|. 1
	ImgBase.SubImage(image.Rect(128, 80, 144, 96)).(*ebiten.Image), // |... 2
	ImgBase.SubImage(image.Rect(160, 16, 176, 32)).(*ebiten.Image), // .|.. 3
	ImgBase.SubImage(image.Rect(176, 16, 192, 32)).(*ebiten.Image), // .|.| 4
	ImgBase.SubImage(image.Rect(192, 16, 208, 32)).(*ebiten.Image), // ...| 5
	ImgBase.SubImage(image.Rect(160, 48, 176, 64)).(*ebiten.Image), // .||. 6
	ImgBase.SubImage(image.Rect(176, 48, 192, 64)).(*ebiten.Image), // .||| 7
	ImgBase.SubImage(image.Rect(192, 48, 208, 64)).(*ebiten.Image), // ..|| 8
	ImgBase.SubImage(image.Rect(160, 64, 176, 80)).(*ebiten.Image), // |.|| 9
	ImgBase.SubImage(image.Rect(176, 64, 192, 80)).(*ebiten.Image), // .... 10
	ImgBase.SubImage(image.Rect(192, 64, 208, 80)).(*ebiten.Image), // |.|| 11
	ImgBase.SubImage(image.Rect(160, 80, 176, 96)).(*ebiten.Image), // ||.. 12
	ImgBase.SubImage(image.Rect(176, 80, 192, 96)).(*ebiten.Image), // ||.| 13
	ImgBase.SubImage(image.Rect(192, 80, 208, 96)).(*ebiten.Image), // |..| 14
	ImgBase.SubImage(image.Rect(224, 16, 240, 32)).(*ebiten.Image), // sp 15
	ImgBase.SubImage(image.Rect(224, 48, 240, 64)).(*ebiten.Image), // sp 16
}

var AllMap = [][]*Structure{
	{
		// CITY
		{
			// walls
			CreateTile(416, 16, 176, 48, true),
			CreateTile(432, 16, 176, 48, true),
			CreateTile(448, 16, 176, 48, true),
			CreateTile(464, 16, 176, 48, true),
			CreateTile(240, 48, 176, 48, true),
			CreateTile(256, 48, 176, 48, true),
			CreateTile(272, 48, 176, 48, true),
			CreateTile(288, 48, 176, 48, true),
			CreateTile(304, 48, 176, 48, true),
			CreateTile(320, 48, 176, 48, true),
			CreateTile(80, 64, 176, 48, true),
			CreateTile(96, 64, 176, 48, true),
			CreateTile(112, 64, 176, 48, true),
			CreateTile(128, 64, 176, 48, true),
			CreateTile(144, 64, 176, 48, true),
			CreateTile(240, 128, 176, 48, true),
			CreateTile(256, 128, 176, 48, true),
			CreateTile(64, 144, 176, 48, true),
			CreateTile(80, 144, 176, 48, true),
			CreateTile(96, 144, 176, 48, true),
			CreateTile(112, 144, 176, 48, true),
			CreateTile(128, 144, 176, 48, true),
			CreateTile(416, 208, 176, 48, true),
			CreateTile(80, 224, 176, 48, true),
			CreateTile(96, 224, 176, 48, true),
			CreateTile(112, 224, 176, 48, true),
			CreateTile(128, 224, 176, 48, true),
			CreateTile(144, 224, 176, 48, true),
			CreateTile(240, 256, 176, 48, true),
			CreateTile(256, 256, 176, 48, true),
			CreateTile(272, 256, 176, 48, true),
			CreateTile(288, 256, 176, 48, true),
			CreateTile(384, 256, 176, 48, true),
			CreateTile(480, 32, 192, 64, true),
			CreateTile(416, 112, 192, 64, true),
			CreateTile(416, 128, 192, 64, true),
			CreateTile(272, 144, 192, 64, true),
			CreateTile(272, 160, 192, 64, true),
			CreateTile(272, 176, 192, 64, true),
			CreateTile(432, 224, 192, 64, true),
			CreateTile(160, 240, 192, 64, true),
			CreateTile(432, 240, 192, 64, true),
			CreateTile(432, 256, 192, 64, true),
			CreateTile(112, 272, 192, 64, true),
			CreateTile(304, 272, 192, 64, true),
			CreateTile(432, 272, 192, 64, true),
			CreateTile(112, 288, 192, 64, true),
			CreateTile(304, 288, 192, 64, true),
			CreateTile(432, 288, 192, 64, true),
			CreateTile(112, 304, 192, 64, true),
			CreateTile(416, 32, 176, 80, true),
			CreateTile(432, 32, 176, 80, true),
			CreateTile(448, 32, 176, 80, true),
			CreateTile(464, 32, 176, 80, true),
			CreateTile(240, 64, 176, 80, true),
			CreateTile(256, 64, 176, 80, true),
			CreateTile(272, 64, 176, 80, true),
			CreateTile(288, 64, 176, 80, true),
			CreateTile(304, 64, 176, 80, true),
			CreateTile(320, 64, 176, 80, true),
			CreateTile(80, 80, 176, 80, true),
			CreateTile(96, 80, 176, 80, true),
			CreateTile(112, 80, 176, 80, true),
			CreateTile(128, 80, 176, 80, true),
			CreateTile(144, 80, 176, 80, true),
			CreateTile(64, 160, 176, 80, true),
			CreateTile(80, 160, 176, 80, true),
			CreateTile(96, 160, 176, 80, true),
			CreateTile(112, 160, 176, 80, true),
			CreateTile(128, 160, 176, 80, true),
			CreateTile(240, 192, 176, 80, true),
			CreateTile(256, 192, 176, 80, true),
			CreateTile(128, 256, 176, 80, true),
			CreateTile(144, 256, 176, 80, true),
			CreateTile(240, 272, 176, 80, true),
			CreateTile(256, 272, 176, 80, true),
			CreateTile(272, 272, 176, 80, true),
			CreateTile(384, 304, 176, 80, true),
			CreateTile(400, 304, 176, 80, true),
			CreateTile(416, 304, 176, 80, true),
			CreateTile(80, 320, 176, 80, true),
			CreateTile(96, 320, 176, 80, true),
			CreateTile(400, 112, 160, 64, true),
			CreateTile(400, 128, 160, 64, true),
			CreateTile(224, 176, 160, 64, true),
			CreateTile(400, 224, 160, 64, true),
			CreateTile(64, 240, 160, 64, true),
			CreateTile(400, 240, 160, 64, true),
			CreateTile(64, 256, 160, 64, true),
			CreateTile(64, 272, 160, 64, true),
			CreateTile(368, 272, 160, 64, true),
			CreateTile(64, 288, 160, 64, true),
			CreateTile(288, 288, 160, 64, true),
			CreateTile(368, 288, 160, 64, true),
			CreateTile(64, 304, 160, 64, true),
			CreateTile(480, 16, 192, 48, true),
			CreateTile(336, 48, 192, 48, true),
			CreateTile(160, 64, 192, 48, true),
			CreateTile(416, 96, 192, 48, true),
			CreateTile(272, 128, 192, 48, true),
			CreateTile(144, 144, 192, 48, true),
			CreateTile(432, 208, 192, 48, true),
			CreateTile(160, 224, 192, 48, true),
			CreateTile(304, 256, 192, 48, true),
			CreateTile(400, 32, 160, 80, true),
			CreateTile(224, 64, 160, 80, true),
			CreateTile(64, 80, 160, 80, true),
			CreateTile(400, 144, 160, 80, true),
			CreateTile(48, 160, 160, 80, true),
			CreateTile(208, 160, 160, 80, true),
			CreateTile(224, 192, 160, 80, true),
			CreateTile(224, 272, 160, 80, true),
			CreateTile(288, 304, 160, 80, true),
			CreateTile(368, 304, 160, 80, true),
			CreateTile(64, 320, 160, 80, true),
			CreateTile(336, 64, 192, 80, true),
			CreateTile(160, 80, 192, 80, true),
			CreateTile(416, 144, 192, 80, true),
			CreateTile(144, 160, 192, 80, true),
			CreateTile(272, 192, 192, 80, true),
			CreateTile(160, 256, 192, 80, true),
			CreateTile(304, 304, 192, 80, true),
			CreateTile(432, 304, 192, 80, true),
			CreateTile(112, 320, 192, 80, true),
			CreateTile(480, 48, 128, 64, true),
			CreateTile(480, 64, 128, 64, true),
			CreateTile(336, 128, 128, 64, true),
			CreateTile(336, 144, 128, 64, true),
			CreateTile(336, 160, 128, 64, true),
			CreateTile(336, 176, 128, 64, true),
			CreateTile(480, 80, 128, 80, true),
			CreateTile(336, 192, 128, 80, true),
			CreateTile(400, 16, 160, 48, true),
			CreateTile(224, 48, 160, 48, true),
			CreateTile(64, 64, 160, 48, true),
			CreateTile(400, 96, 160, 48, true),
			CreateTile(224, 128, 160, 48, true),
			CreateTile(48, 144, 160, 48, true),
			CreateTile(208, 144, 160, 48, true),
			CreateTile(400, 208, 160, 48, true),
			CreateTile(64, 224, 160, 48, true),
			CreateTile(224, 256, 160, 48, true),
			CreateTile(368, 256, 160, 48, true),
			CreateTile(336, 112, 128, 48, true),
			CreateTile(224, 144, 176, 64, true),
			CreateTile(240, 144, 176, 64, true),
			CreateTile(256, 144, 176, 64, true),
			CreateTile(240, 160, 176, 64, true),
			CreateTile(256, 160, 176, 64, true),
			CreateTile(240, 176, 176, 64, true),
			CreateTile(256, 176, 176, 64, true),
			CreateTile(416, 224, 176, 64, true),
			CreateTile(80, 240, 176, 64, true),
			CreateTile(96, 240, 176, 64, true),
			CreateTile(112, 240, 176, 64, true),
			CreateTile(128, 240, 176, 64, true),
			CreateTile(144, 240, 176, 64, true),
			CreateTile(416, 240, 176, 64, true),
			CreateTile(80, 256, 176, 64, true),
			CreateTile(96, 256, 176, 64, true),
			CreateTile(400, 256, 176, 64, true),
			CreateTile(416, 256, 176, 64, true),
			CreateTile(80, 272, 176, 64, true),
			CreateTile(96, 272, 176, 64, true),
			CreateTile(384, 272, 176, 64, true),
			CreateTile(400, 272, 176, 64, true),
			CreateTile(416, 272, 176, 64, true),
			CreateTile(80, 288, 176, 64, true),
			CreateTile(96, 288, 176, 64, true),
			CreateTile(384, 288, 176, 64, true),
			CreateTile(400, 288, 176, 64, true),
			CreateTile(416, 288, 176, 64, true),
			CreateTile(80, 304, 176, 64, true),
			CreateTile(96, 304, 176, 64, true),
			CreateTile(112, 256, 224, 48, true),
			CreateTile(224, 160, 224, 16, true),
			CreateTile(288, 272, 224, 16, true),

			// roads

			CreateTile(176, 112, 64, 160, false),
			CreateTile(32, 192, 64, 160, false),
			CreateTile(336, 224, 64, 160, false),
			CreateTile(192, 32, 80, 176, false),
			CreateTile(32, 112, 64, 192, false),
			CreateTile(448, 176, 64, 192, false),
			CreateTile(176, 192, 64, 192, false),
			CreateTile(304, 224, 64, 192, false),
			CreateTile(336, 336, 64, 192, false),
			CreateTile(368, 64, 48, 176, false),
			CreateTile(192, 96, 48, 176, false),
			CreateTile(368, 176, 48, 176, false),
			CreateTile(192, 224, 48, 176, false),
			CreateTile(192, 336, 48, 176, false),
			CreateTile(368, 16, 80, 160, false),
			CreateTile(448, 64, 80, 160, false),
			CreateTile(304, 96, 80, 160, false),
			CreateTile(464, 176, 80, 160, false),
			CreateTile(192, 192, 80, 160, false),
			CreateTile(16, 192, 48, 192, false),
			CreateTile(32, 352, 48, 192, false),
			CreateTile(192, 112, 80, 192, false),
			CreateTile(368, 224, 80, 192, false),
			CreateTile(464, 336, 80, 192, false),
			CreateTile(192, 352, 80, 192, false),
			CreateTile(208, 16, 64, 128, false),
			CreateTile(224, 16, 64, 128, false),
			CreateTile(240, 16, 64, 128, false),
			CreateTile(256, 16, 64, 128, false),
			CreateTile(272, 16, 64, 128, false),
			CreateTile(288, 16, 64, 128, false),
			CreateTile(304, 16, 64, 128, false),
			CreateTile(320, 16, 64, 128, false),
			CreateTile(336, 16, 64, 128, false),
			CreateTile(352, 16, 64, 128, false),
			CreateTile(48, 32, 64, 128, false),
			CreateTile(64, 32, 64, 128, false),
			CreateTile(80, 32, 64, 128, false),
			CreateTile(96, 32, 64, 128, false),
			CreateTile(112, 32, 64, 128, false),
			CreateTile(128, 32, 64, 128, false),
			CreateTile(144, 32, 64, 128, false),
			CreateTile(160, 32, 64, 128, false),
			CreateTile(176, 32, 64, 128, false),
			CreateTile(384, 64, 64, 128, false),
			CreateTile(400, 64, 64, 128, false),
			CreateTile(416, 64, 64, 128, false),
			CreateTile(432, 64, 64, 128, false),
			CreateTile(208, 96, 64, 128, false),
			CreateTile(224, 96, 64, 128, false),
			CreateTile(240, 96, 64, 128, false),
			CreateTile(256, 96, 64, 128, false),
			CreateTile(272, 96, 64, 128, false),
			CreateTile(288, 96, 64, 128, false),
			CreateTile(48, 112, 64, 128, false),
			CreateTile(64, 112, 64, 128, false),
			CreateTile(80, 112, 64, 128, false),
			CreateTile(96, 112, 64, 128, false),
			CreateTile(112, 112, 64, 128, false),
			CreateTile(128, 112, 64, 128, false),
			CreateTile(144, 112, 64, 128, false),
			CreateTile(160, 112, 64, 128, false),
			CreateTile(384, 176, 64, 128, false),
			CreateTile(400, 176, 64, 128, false),
			CreateTile(416, 176, 64, 128, false),
			CreateTile(432, 176, 64, 128, false),
			CreateTile(48, 192, 64, 128, false),
			CreateTile(64, 192, 64, 128, false),
			CreateTile(80, 192, 64, 128, false),
			CreateTile(96, 192, 64, 128, false),
			CreateTile(112, 192, 64, 128, false),
			CreateTile(128, 192, 64, 128, false),
			CreateTile(144, 192, 64, 128, false),
			CreateTile(160, 192, 64, 128, false),
			CreateTile(208, 224, 64, 128, false),
			CreateTile(224, 224, 64, 128, false),
			CreateTile(240, 224, 64, 128, false),
			CreateTile(256, 224, 64, 128, false),
			CreateTile(272, 224, 64, 128, false),
			CreateTile(288, 224, 64, 128, false),
			CreateTile(320, 224, 64, 128, false),
			CreateTile(352, 224, 64, 128, false),
			CreateTile(208, 336, 64, 128, false),
			CreateTile(224, 336, 64, 128, false),
			CreateTile(240, 336, 64, 128, false),
			CreateTile(256, 336, 64, 128, false),
			CreateTile(272, 336, 64, 128, false),
			CreateTile(288, 336, 64, 128, false),
			CreateTile(304, 336, 64, 128, false),
			CreateTile(320, 336, 64, 128, false),
			CreateTile(352, 336, 64, 128, false),
			CreateTile(368, 336, 64, 128, false),
			CreateTile(384, 336, 64, 128, false),
			CreateTile(400, 336, 64, 128, false),
			CreateTile(416, 336, 64, 128, false),
			CreateTile(432, 336, 64, 128, false),
			CreateTile(448, 336, 64, 128, false),
			CreateTile(48, 352, 64, 128, false),
			CreateTile(64, 352, 64, 128, false),
			CreateTile(80, 352, 64, 128, false),
			CreateTile(96, 352, 64, 128, false),
			CreateTile(112, 352, 64, 128, false),
			CreateTile(128, 352, 64, 128, false),
			CreateTile(144, 352, 64, 128, false),
			CreateTile(160, 352, 64, 128, false),
			CreateTile(176, 352, 64, 128, false),
			CreateTile(368, 32, 16, 176, false),
			CreateTile(32, 48, 16, 176, false),
			CreateTile(192, 48, 16, 176, false),
			CreateTile(368, 48, 16, 176, false),
			CreateTile(32, 64, 16, 176, false),
			CreateTile(192, 64, 16, 176, false),
			CreateTile(32, 80, 16, 176, false),
			CreateTile(192, 80, 16, 176, false),
			CreateTile(368, 80, 16, 176, false),
			CreateTile(448, 80, 16, 176, false),
			CreateTile(32, 96, 16, 176, false),
			CreateTile(368, 96, 16, 176, false),
			CreateTile(448, 96, 16, 176, false),
			CreateTile(304, 112, 16, 176, false),
			CreateTile(368, 112, 16, 176, false),
			CreateTile(448, 112, 16, 176, false),
			CreateTile(16, 128, 16, 176, false),
			CreateTile(176, 128, 16, 176, false),
			CreateTile(304, 128, 16, 176, false),
			CreateTile(368, 128, 16, 176, false),
			CreateTile(448, 128, 16, 176, false),
			CreateTile(16, 144, 16, 176, false),
			CreateTile(176, 144, 16, 176, false),
			CreateTile(304, 144, 16, 176, false),
			CreateTile(368, 144, 16, 176, false),
			CreateTile(448, 144, 16, 176, false),
			CreateTile(16, 160, 16, 176, false),
			CreateTile(176, 160, 16, 176, false),
			CreateTile(304, 160, 16, 176, false),
			CreateTile(368, 160, 16, 176, false),
			CreateTile(448, 160, 16, 176, false),
			CreateTile(16, 176, 16, 176, false),
			CreateTile(176, 176, 16, 176, false),
			CreateTile(304, 176, 16, 176, false),
			CreateTile(304, 192, 16, 176, false),
			CreateTile(368, 192, 16, 176, false),
			CreateTile(464, 192, 16, 176, false),
			CreateTile(32, 208, 16, 176, false),
			CreateTile(192, 208, 16, 176, false),
			CreateTile(304, 208, 16, 176, false),
			CreateTile(368, 208, 16, 176, false),
			CreateTile(464, 208, 16, 176, false),
			CreateTile(32, 224, 16, 176, false),
			CreateTile(464, 224, 16, 176, false),
			CreateTile(32, 240, 16, 176, false),
			CreateTile(192, 240, 16, 176, false),
			CreateTile(336, 240, 16, 176, false),
			CreateTile(464, 240, 16, 176, false),
			CreateTile(32, 256, 16, 176, false),
			CreateTile(192, 256, 16, 176, false),
			CreateTile(336, 256, 16, 176, false),
			CreateTile(464, 256, 16, 176, false),
			CreateTile(32, 272, 16, 176, false),
			CreateTile(192, 272, 16, 176, false),
			CreateTile(336, 272, 16, 176, false),
			CreateTile(464, 272, 16, 176, false),
			CreateTile(32, 288, 16, 176, false),
			CreateTile(192, 288, 16, 176, false),
			CreateTile(336, 288, 16, 176, false),
			CreateTile(464, 288, 16, 176, false),
			CreateTile(32, 304, 16, 176, false),
			CreateTile(192, 304, 16, 176, false),
			CreateTile(336, 304, 16, 176, false),
			CreateTile(464, 304, 16, 176, false),
			CreateTile(32, 320, 16, 176, false),
			CreateTile(192, 320, 16, 176, false),
			CreateTile(336, 320, 16, 176, false),
			CreateTile(464, 320, 16, 176, false),
			CreateTile(32, 336, 16, 176, false),
			CreateTile(192, 16, 48, 160, false),
			CreateTile(32, 32, 48, 160, false),
			CreateTile(16, 112, 48, 160, false),
		},
		// RIVER
	},
}

func CreateTile(x int, y int, imgX int, imgY int, isSolid bool) Tile {
	var img = ImgBase.SubImage(image.Rect(imgX, imgY, imgX+16, imgY+16)).(*ebiten.Image)
	return Tile{isSolid, &RigidBody{x, y, 16, 16}, img}
}

type Structure []Tile

func (s *Structure) Draw(screen *ebiten.Image) {
	for _, i := range *s {
		if i.Colide {
			i.Draw(screen)
		}
	}
}

func (s *Structure) DrawBefore(screen *ebiten.Image) {
	for _, i := range *s {
		if !i.Colide {
			i.Draw(screen)
		}
	}
}

func (s *Structure) Collide(r *RigidBody) bool {
	for _, i := range *s {
		if i.Colide {
			if i.RigidBody.Collide(r) {
				return true
			}
		}
	}
	return false
}
